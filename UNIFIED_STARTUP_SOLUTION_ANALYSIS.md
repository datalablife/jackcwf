# ğŸš€ ç»Ÿä¸€å¯åŠ¨ç³»ç»Ÿæ–¹æ¡ˆåˆ†ææŠ¥å‘Š
## åŸºäº Docker + Coolify éƒ¨ç½²ç¯å¢ƒ

**åˆ†ææ—¥æœŸ**: 2025-11-12
**çŠ¶æ€**: æ·±åº¦ç ”è®¨å®Œæˆ

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

### é‡è¦å‘ç°ï¼šéƒ¨ç½²æ¶æ„çš„æ ¹æœ¬å·®å¼‚

æ‚¨çš„æŒ‡å‡ºæ”¹å˜äº†æ•´ä¸ªè®¾è®¡ï¼š
- **å¼€å‘ç¯å¢ƒ**: è£¸æœº Linuxï¼ˆæœ¬åœ°æœåŠ¡å™¨ï¼‰
- **ç”Ÿäº§ç¯å¢ƒ**: Docker å®¹å™¨ï¼ˆCoolify å¹³å°ï¼‰
- **æ•°æ®åº“**: äº‘æ‰˜ç®¡ PostgreSQL

**è¿™æ„å‘³ç€ï¼šå¯åŠ¨è„šæœ¬éœ€è¦å¤„ç†ä¸¤ç§å®Œå…¨ä¸åŒçš„è¿è¡Œç¯å¢ƒ**

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šæ¶æ„åˆ†æ

### 1. å®¹å™¨åŒ–ä¸è£¸æœºéƒ¨ç½²çš„æ ¹æœ¬åŒºåˆ«

#### è£¸æœºéƒ¨ç½²ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
```
âœ ç›´æ¥è¿è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤
âœ å¯ä»¥åå°è¿è¡Œè¿›ç¨‹ï¼ˆ&ï¼‰
âœ å¯ä»¥ä½¿ç”¨ systemd/supervisor ç®¡ç†è¿›ç¨‹
âœ PID ä¸å—é™åˆ¶
âœ å¯ä»¥è®¿é—®ç³»ç»Ÿèµ„æº
âœ æ—¥å¿—å¯ä»¥å†™å…¥æ–‡ä»¶ç³»ç»Ÿ
```

#### å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```
âœ å®¹å™¨ä½œä¸ºéš”ç¦»çš„æ²™ç®±
âœ å®¹å™¨å†…é€šå¸¸åªè¿è¡Œä¸€ä¸ªä¸»è¿›ç¨‹ï¼ˆPID 1ï¼‰
âœ æ— æ³•ä½¿ç”¨ systemdï¼ˆé€šå¸¸ï¼‰
âœ è¿›ç¨‹ç®¡ç†ç”±å®¹å™¨è¿è¡Œæ—¶ï¼ˆDockerï¼‰è´Ÿè´£
âœ èµ„æºå—é™ï¼ˆCPUã€å†…å­˜ï¼‰
âœ æ—¥å¿—åº”è¾“å‡ºåˆ° stdout/stderrï¼ˆDocker æ—¥å¿—é©±åŠ¨æ¥ç®¡ï¼‰
âœ ä¼˜é›…å…³é—­ï¼ˆgraceful shutdownï¼‰æå…¶é‡è¦
```

### 2. Coolify å¹³å°ç‰¹æ€§ç†è§£

#### Coolify çš„å·¥ä½œæ–¹å¼
```
Coolify æ˜¯ Docker è‡ªåŠ¨åŒ–éƒ¨ç½²å¹³å°ï¼Œç±»ä¼¼äº Herokuï¼š

1. ç”¨æˆ·æ¨é€ä»£ç åˆ° GitHub
2. Coolify æ‹‰å–ä»£ç ï¼Œæ„å»º Docker é•œåƒ
3. è¿è¡Œå®¹å™¨ï¼Œç®¡ç†ç”Ÿå‘½å‘¨æœŸ
4. æä¾›ç›‘æ§ã€æ—¥å¿—ã€è‡ªåŠ¨é‡å¯ç­‰åŠŸèƒ½
5. å¤„ç†ç¯å¢ƒå˜é‡æ³¨å…¥
6. ç®¡ç†å®¹å™¨ç½‘ç»œå’Œå­˜å‚¨

å…³é”®ç‚¹ï¼š
âœ“ Coolify æ§åˆ¶å®¹å™¨å¯åŠ¨/åœæ­¢
âœ— æˆ‘ä»¬çš„è„šæœ¬åœ¨å®¹å™¨å†…è¿è¡Œï¼Œæ— æ³•æ§åˆ¶å®¹å™¨æœ¬èº«
âœ“ æˆ‘ä»¬åªèƒ½æ§åˆ¶å®¹å™¨å†…çš„è¿›ç¨‹
```

#### Coolify çš„ä¸‰ç§å¯åŠ¨æ–¹å¼
```
æ–¹å¼ 1: Dockerfile ENTRYPOINT
â”œâ”€ æœ€å¸¸è§ï¼Œå®Œå…¨æ§åˆ¶å¯åŠ¨æµç¨‹
â””â”€ æˆ‘ä»¬çš„è„šæœ¬ä¼šåœ¨è¿™é‡Œè¿è¡Œ

æ–¹å¼ 2: docker-compose
â”œâ”€ é€‚åˆå¤šå®¹å™¨åº”ç”¨
â””â”€ å‰åç«¯å¯èƒ½åˆ†ç¦»

æ–¹å¼ 3: ç›´æ¥ CMD
â”œâ”€ ç®€å•åº”ç”¨
â””â”€ ç¼ºå°‘çµæ´»æ€§
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šå…³é”®æŠ€æœ¯å†³ç­–

### å†³ç­– 1ï¼šå®¹å™¨å¯åŠ¨ç­–ç•¥

#### é€‰é¡¹ A: å•ä¸€å®¹å™¨ï¼ˆå‰åç«¯åœ¨ä¸€ä¸ªå®¹å™¨ï¼‰
```bash
âœ“ ä¼˜ç‚¹ï¼š
  - ç®€åŒ–éƒ¨ç½²
  - ç®€åŒ–ç½‘ç»œé…ç½®
  - èµ„æºåˆ©ç”¨ç‡é«˜
  - ä¸ Coolify é›†æˆç®€å•

âœ— ç¼ºç‚¹ï¼š
  - æ‰©å±•æ€§å·®ï¼ˆå‰åç«¯ç‹¬ç«‹æ‰©å®¹å›°éš¾ï¼‰
  - é‡å¯å½±å“ä¸¤ä¸ªæœåŠ¡
  - èµ„æºäº‰ç”¨
  - æ—¥å¿—æ··æ·†
```

#### é€‰é¡¹ B: å¤šå®¹å™¨ï¼ˆdocker-composeï¼‰
```bash
âœ“ ä¼˜ç‚¹ï¼š
  - å‰åç«¯ç‹¬ç«‹ç®¡ç†
  - æ›´å¥½çš„èµ„æºéš”ç¦»
  - å¯ç‹¬ç«‹æ‰©å±•
  - æ—¥å¿—æ¸…æ™°
  - æ›´ç¬¦åˆå¾®æœåŠ¡æ€æƒ³

âœ— ç¼ºç‚¹ï¼š
  - ç½‘ç»œé…ç½®å¤æ‚
  - Coolify ä¸ç›´æ¥æ”¯æŒ docker-compose
  - éœ€è¦ç¼–æ’å·¥å…·ï¼ˆKubernetes, Nomad ç­‰ï¼‰
  - å¼€å‘ç¯å¢ƒå¤æ‚åº¦å¢åŠ 
```

**æ¨èï¼šå•ä¸€å®¹å™¨** - å¯¹äº Coolify éƒ¨ç½²æœ€å®ç”¨

### å†³ç­– 2ï¼šå®¹å™¨å†…è¿›ç¨‹ç®¡ç†

#### é€‰é¡¹ A: ç›´æ¥è¿è¡Œè¿›ç¨‹ï¼ˆç®€å•ï¼‰
```bash
# Dockerfile
CMD ["python", "-m", "uvicorn", "main:app"]

âœ“ ä¼˜ç‚¹ï¼š
  - ç®€å•ï¼Œæ˜“ç»´æŠ¤
  - Docker å¯ç›´æ¥ç®¡ç†è¿›ç¨‹ç”Ÿå‘½å‘¨æœŸ
  - æ—¥å¿—æ¸…æ™°ï¼ˆstdout/stderrï¼‰

âœ— ç¼ºç‚¹ï¼š
  - åªèƒ½è¿è¡Œä¸€ä¸ªè¿›ç¨‹
  - æ— æ³•åŒæ—¶è¿è¡Œåç«¯å’Œå‰ç«¯
```

#### é€‰é¡¹ B: è¿›ç¨‹ç®¡ç†å™¨ï¼ˆå¦‚ supervisord, s6ï¼‰
```bash
# Dockerfile
RUN apt-get install supervisor
COPY supervisor.conf /etc/supervisor/conf.d/
CMD ["/usr/bin/supervisord", "-c", "/etc/supervisor/conf.d/supervisord.conf"]

âœ“ ä¼˜ç‚¹ï¼š
  - å¯è¿è¡Œå¤šä¸ªè¿›ç¨‹
  - è‡ªåŠ¨é‡å¯å¤±è´¥çš„è¿›ç¨‹
  - çµæ´»çš„è¿›ç¨‹ç®¡ç†

âœ— ç¼ºç‚¹ï¼š
  - å¢åŠ å¤æ‚åº¦
  - å®¹å™¨æ—¥å¿—ç®¡ç†å›°éš¾
  - ä¸ç¬¦åˆ"ä¸€å®¹å™¨ä¸€è¿›ç¨‹"æœ€ä½³å®è·µ
```

#### é€‰é¡¹ C: Shell è„šæœ¬ + åå°è¿è¡Œ
```bash
# Dockerfile
COPY start.sh /app/
CMD ["/app/start.sh"]

# start.sh
#!/bin/bash
python -m uvicorn main:app &
cd frontend && npm run build && serve -s dist -l 3000 &
wait  # ç­‰å¾…ä»»ä½•è¿›ç¨‹ç»“æŸ

âœ“ ä¼˜ç‚¹ï¼š
  - çµæ´»åº¦é«˜
  - å¯åŒæ—¶è¿è¡Œå¤šä¸ªæœåŠ¡

âœ— ç¼ºç‚¹ï¼š
  - ä¿¡å·å¤„ç†å¤æ‚
  - æ—¥å¿—ç®¡ç†å›°éš¾
  - ä¼˜é›…å…³é—­å®ç°å¤æ‚
  - éœ€è¦ä¸¥è°¨çš„ Shell ç¼–ç¨‹
```

**æ¨èï¼šé€‰é¡¹ Aï¼ˆåˆ†ç¦»å®¹å™¨ï¼‰æˆ– é€‰é¡¹ Cï¼ˆShell è„šæœ¬ + ä¿¡å·å¤„ç†ï¼‰**

### å†³ç­– 3ï¼šå¼€å‘ vs ç”Ÿäº§ç»Ÿä¸€æ€§

#### å½“å‰çš„ä¸¤éš¾é€‰æ‹©
```
å¼€å‘ç¯å¢ƒï¼šéœ€è¦å¿«é€Ÿè¿­ä»£ï¼Œçƒ­é‡è½½ï¼Œä¾¿æ·å¯åŠ¨
ç”Ÿäº§ç¯å¢ƒï¼šéœ€è¦ç¨³å®šæ€§ï¼Œæœ€å°åŒ–ï¼Œå®‰å…¨æ€§

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–¹æ¡ˆ A: å®Œå…¨ç»Ÿä¸€çš„è„šæœ¬                   â”‚
â”‚ ä¼˜ç‚¹ï¼šå‡å°‘è„‘åŠ›æ¶ˆè€—ï¼Œä¿è¯ä¸€è‡´æ€§            â”‚
â”‚ ç¼ºç‚¹ï¼šä¸ºäº†é€‚åº”ä¸¤ç§ç¯å¢ƒï¼Œè„šæœ¬ä¼šå¾ˆå¤æ‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–¹æ¡ˆ B: ç¯å¢ƒç‰¹å®šçš„è„šæœ¬                   â”‚
â”‚ ä¼˜ç‚¹ï¼šæ¯ä¸ªç¯å¢ƒçš„è„šæœ¬éƒ½æ˜¯ä¼˜åŒ–çš„            â”‚
â”‚ ç¼ºç‚¹ï¼šç»´æŠ¤å¤šå¥—è„šæœ¬ï¼Œå®¹æ˜“ä¸ä¸€è‡´            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–¹æ¡ˆ C: æ··åˆæ–¹æ¡ˆï¼ˆæ¨èï¼‰                 â”‚
â”‚ å…±äº«ï¼šæ ¸å¿ƒåŠŸèƒ½åº“ï¼ˆå‰æ£€æŸ¥ã€æ•°æ®åº“ã€æ—¥å¿—ï¼‰  â”‚
â”‚ åˆ†ç¦»ï¼šå¯åŠ¨è„šæœ¬æœ¬èº«ï¼ˆdev.sh vs prod.shï¼‰  â”‚
â”‚ æ”¶ç›Šï¼šæœ€å¤§çµæ´»æ€§ + ä»£ç å¤ç”¨               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ¨èï¼šæ–¹æ¡ˆ C - æ··åˆæ–¹æ¡ˆ**

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šæœ€ä½³å®è·µæ–¹æ¡ˆè®¾è®¡

### æ–¹æ¡ˆåç§°ï¼š
**"åŒç¯å¢ƒå¯åŠ¨ç³»ç»Ÿ - å¼€å‘ä¼˜åŒ– + å®¹å™¨å°±ç»ª"**

### æ ¸å¿ƒæ¶æ„

```
scripts/
â”œâ”€â”€ launcher.sh              # é€šç”¨å¯åŠ¨å™¨ï¼ˆæœ‰æ¡ä»¶åœ°é€‰æ‹©ç¯å¢ƒï¼‰
â”‚
â”œâ”€â”€ lib/                     # å…±äº«åŠŸèƒ½åº“ï¼ˆä¸¤ä¸ªç¯å¢ƒéƒ½ç”¨ï¼‰
â”‚   â”œâ”€â”€ ui.sh               # UI å’Œé¢œè‰²è¾“å‡º
â”‚   â”œâ”€â”€ utils.sh            # é€šç”¨å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ preflight.sh        # é¢„æ£€æŸ¥ï¼ˆå¯åœ¨ä¸¤ä¸ªç¯å¢ƒä¸­è¿è¡Œï¼‰
â”‚   â”œâ”€â”€ database.sh         # æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ logging.sh          # æ—¥å¿—ç®¡ç†ï¼ˆæ”¯æŒæ–‡ä»¶å’Œ stdoutï¼‰
â”‚   â”œâ”€â”€ signals.sh          # ä¿¡å·å¤„ç†ï¼ˆç‰¹åˆ«é‡è¦ï¼ï¼‰
â”‚   â””â”€â”€ health.sh           # å¥åº·æ£€æŸ¥
â”‚
â”œâ”€â”€ dev/                     # å¼€å‘ç¯å¢ƒä¸“ç”¨
â”‚   â”œâ”€â”€ start.sh            # å¼€å‘å¯åŠ¨è„šæœ¬ï¼ˆä½¿ç”¨çƒ­é‡è½½ï¼‰
â”‚   â”œâ”€â”€ config.env          # å¼€å‘é…ç½®
â”‚   â””â”€â”€ Makefile            # ä¾¿æ·å‘½ä»¤
â”‚
â”œâ”€â”€ container/              # å®¹å™¨å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ entrypoint.sh       # Dockerfile ENTRYPOINT
â”‚   â”œâ”€â”€ config.env          # å®¹å™¨é…ç½®
â”‚   â””â”€â”€ supervisord.conf    # (å¦‚æœä½¿ç”¨è¿›ç¨‹ç®¡ç†å™¨)
â”‚
â”œâ”€â”€ config/                 # å…±äº«é…ç½®
â”‚   â”œâ”€â”€ dev.env
â”‚   â”œâ”€â”€ test.env
â”‚   â””â”€â”€ prod.env
â”‚
â””â”€â”€ docker/                 # Docker ç›¸å…³
    â”œâ”€â”€ Dockerfile          # å¤šé˜¶æ®µæ„å»º
    â”œâ”€â”€ .dockerignore
    â””â”€â”€ docker-compose.dev.yml
```

### å¯åŠ¨æµç¨‹å¯¹æ¯”

#### å¼€å‘ç¯å¢ƒå¯åŠ¨æµç¨‹
```
ç”¨æˆ·è¿è¡Œ: ./scripts/dev/start.sh

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç¯å¢ƒæ£€æµ‹                                  â”‚
â”‚    âœ“ æ£€æµ‹æ˜¯å¦åœ¨ Docker å†… -> ä¸æ˜¯            â”‚
â”‚    âœ“ åŠ è½½ scripts/config/dev.env             â”‚
â”‚    âœ“ è®¾ç½®å¼€å‘ç‰¹å®šå˜é‡                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. é¢„æ£€æŸ¥ï¼ˆå¿«é€Ÿç‰ˆæœ¬ï¼‰                       â”‚
â”‚    âœ“ Python å’Œ Poetry                       â”‚
â”‚    âœ“ Node å’Œ npm/pnpm                       â”‚
â”‚    âœ“ æ•°æ®åº“è¿æ¥                             â”‚
â”‚    âœ“ ç«¯å£å¯ç”¨æ€§                             â”‚
â”‚    âš  è·³è¿‡æŸäº›ç”Ÿäº§çº§æ£€æŸ¥ï¼ˆå¿«é€Ÿè¿­ä»£ï¼‰         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. åç«¯å¯åŠ¨ï¼ˆçƒ­é‡è½½æ¨¡å¼ï¼‰                   â”‚
â”‚    âœ“ å®‰è£…ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰                    â”‚
â”‚    âœ“ æ•°æ®åº“è¿ç§»                             â”‚
â”‚    âœ“ å¯åŠ¨ uvicorn --reloadï¼ˆå¼€å‘æ¨¡å¼ï¼‰      â”‚
â”‚    âœ“ ç›‘å¬ä»£ç å˜åŒ–è‡ªåŠ¨é‡å¯                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. å‰ç«¯å¯åŠ¨ï¼ˆVite å¼€å‘æœåŠ¡å™¨ï¼‰              â”‚
â”‚    âœ“ å®‰è£…ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰                    â”‚
â”‚    âœ“ å¯åŠ¨ npm run devï¼ˆViteï¼‰               â”‚
â”‚    âœ“ HMRï¼ˆHot Module Replacementï¼‰          â”‚
â”‚    âœ“ è‡ªåŠ¨åœ¨æµè§ˆå™¨æ‰“å¼€                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. ç›‘æ§å’Œæ—¥å¿—                               â”‚
â”‚    âœ“ å½©è‰²ç»ˆç«¯è¾“å‡º                           â”‚
â”‚    âœ“ ä¸¤ä¸ªæœåŠ¡çš„æ—¥å¿—æ··åˆæ˜¾ç¤º                 â”‚
â”‚    âœ“ æŒ‰ Ctrl+C ä¼˜é›…å…³é—­                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å®¹å™¨å¯åŠ¨æµç¨‹ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```
Coolify è¿è¡Œ: docker run my-app

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Docker å¯åŠ¨å®¹å™¨                           â”‚
â”‚    âœ“ æ‰§è¡Œ ENTRYPOINT: /app/container/entrypoint.sh
â”‚    âœ“ æ³¨å…¥ç¯å¢ƒå˜é‡ï¼ˆCoolify æä¾›ï¼‰            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. entrypoint.sh å¯åŠ¨                       â”‚
â”‚    âœ“ ç¯å¢ƒæ£€æµ‹ï¼šæ£€æµ‹æ˜¯å¦åœ¨ Docker å†… -> æ˜¯   â”‚
â”‚    âœ“ åŠ è½½ container/config.env              â”‚
â”‚    âœ“ è¦†ç›– Coolify æ³¨å…¥çš„ç¯å¢ƒå˜é‡             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. å®Œæ•´çš„ç”Ÿäº§çº§é¢„æ£€æŸ¥                       â”‚
â”‚    âœ“ æ‰€æœ‰ä¾èµ–éªŒè¯                           â”‚
â”‚    âœ“ æ•°æ®åº“è¿æ¥ï¼ˆä¸¥æ ¼ï¼‰                     â”‚
â”‚    âœ“ ç£ç›˜ç©ºé—´ã€å†…å­˜                         â”‚
â”‚    âœ“ å®‰å…¨é…ç½®æ£€æŸ¥                           â”‚
â”‚    âœ— å¤±è´¥åˆ™ç«‹å³é€€å‡ºï¼ˆè®© Docker é‡å¯ï¼‰       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. æ•°æ®åº“è¿ç§»ï¼ˆå…³é”®ï¼ï¼‰                     â”‚
â”‚    âœ“ è¿è¡Œ Alembic upgrade head              â”‚
â”‚    âœ“ å¦‚æœå¤±è´¥ï¼Œå›æ»šå¹¶ä¸­æ­¢å¯åŠ¨                â”‚
â”‚    âœ“ æˆåŠŸåæ‰ç»§ç»­                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. åç«¯å¯åŠ¨ï¼ˆç”Ÿäº§æ¨¡å¼ï¼‰                     â”‚
â”‚    âœ“ æ„å»ºå‰ç«¯ï¼ˆæˆ–ä½¿ç”¨é¢„æ„å»ºçš„é™æ€æ–‡ä»¶ï¼‰      â”‚
â”‚    âœ“ å¯åŠ¨ uvicornï¼ˆ4 workersï¼Œæ—  reloadï¼‰   â”‚
â”‚    âœ“ å¯åŠ¨å‰ç«¯é™æ€æœåŠ¡ï¼ˆgunicorn æˆ– nginxï¼‰  â”‚
â”‚    âœ“ PID 1 è®¾ç½®ä¸ºåç«¯è¿›ç¨‹                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. è®¾ç½®ä¿¡å·å¤„ç†ï¼ˆä¼˜é›…å…³é—­ï¼‰                 â”‚
â”‚    âœ“ SIGTERM -> ä¼˜é›…å…³é—­ï¼ˆç­‰å¾…è¿æ¥å®Œæˆï¼‰    â”‚
â”‚    âœ“ SIGINT -> å¿«é€Ÿå…³é—­                     â”‚
â”‚    âœ“ é€šçŸ¥ Coolify å®¹å™¨å‡†å¤‡å°±ç»ª              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. æ—¥å¿—ç®¡ç†                                  â”‚
â”‚    âœ“ æ‰€æœ‰æ—¥å¿—è¾“å‡ºåˆ° stdout/stderr            â”‚
â”‚    âœ“ Docker æ—¥å¿—é©±åŠ¨æ¥ç®¡ï¼ˆCoolify æ”¶é›†ï¼‰    â”‚
â”‚    âœ“ å¯åœ¨ Coolify UI ä¸­æŸ¥çœ‹                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. å¥åº·æ£€æŸ¥ï¼ˆç”± Coolify ç®¡ç†ï¼‰              â”‚
â”‚    âœ“ å®šæœŸè¯·æ±‚ /health ç«¯ç‚¹                  â”‚
â”‚    âœ“ å¦‚æœå¥åº·æ£€æŸ¥å¤±è´¥ï¼ŒCoolify é‡å¯å®¹å™¨     â”‚
â”‚    âœ“ å¦‚æœè¿ç»­å¤±è´¥ï¼Œæ ‡è®°å®¹å™¨ä¸ºæ•…éšœ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬å››éƒ¨åˆ†ï¼šå…³é”®æŠ€æœ¯å®ç°

### 1. ç¯å¢ƒæ£€æµ‹æœºåˆ¶ï¼ˆæœ€é‡è¦ï¼ï¼‰

```bash
# åœ¨ lib/utils.sh ä¸­
detect_environment() {
    # æ–¹æ³• 1: æ£€æŸ¥æ˜¯å¦åœ¨ Docker å†…
    if [ -f "/.dockerenv" ]; then
        ENVIRONMENT="container"
        IS_CONTAINER=true
    elif grep -q "docker" /proc/1/cgroup 2>/dev/null; then
        ENVIRONMENT="container"
        IS_CONTAINER=true
    else
        # æ£€æŸ¥æ˜¯å¦åœ¨å¼€å‘æœºä¸Š
        if [ -d ".git" ]; then
            ENVIRONMENT="development"
        else
            ENVIRONMENT="production"  # è£¸æœºç”Ÿäº§
        fi
        IS_CONTAINER=false
    fi

    export ENVIRONMENT IS_CONTAINER
}

# ä½¿ç”¨
if [ "$IS_CONTAINER" = "true" ]; then
    # å®¹å™¨å¯åŠ¨é€»è¾‘
    log_to_stdout "Running in container"
else
    # æœ¬åœ°å¯åŠ¨é€»è¾‘
    log_to_file "Running locally"
fi
```

### 2. ä¿¡å·å¤„ç†ï¼ˆä¼˜é›…å…³é—­ï¼‰

```bash
# åœ¨ lib/signals.sh ä¸­
setup_signal_handlers() {
    # SIGTERM: ä¼˜é›…å…³é—­
    trap 'graceful_shutdown SIGTERM' SIGTERM

    # SIGINT: ç”¨æˆ·ä¸­æ–­ï¼ˆCtrl+Cï¼‰
    trap 'graceful_shutdown SIGINT' INT

    # EXIT: æ¸…ç†èµ„æº
    trap 'cleanup_resources' EXIT
}

graceful_shutdown() {
    local signal=$1
    log_info "launcher" "Received $signal, initiating graceful shutdown..."

    # é€šçŸ¥åç«¯ä¼˜é›…å…³é—­
    if [ -n "$BACKEND_PID" ]; then
        log_info "launcher" "Shutting down backend (PID: $BACKEND_PID)"
        kill -TERM $BACKEND_PID

        # ç­‰å¾…æœ€å¤š 30 ç§’
        local wait_count=0
        while kill -0 $BACKEND_PID 2>/dev/null && [ $wait_count -lt 30 ]; do
            sleep 1
            wait_count=$((wait_count + 1))
        done

        # å¦‚æœè¿˜åœ¨è¿è¡Œï¼Œå¼ºåˆ¶æ€æ­»
        if kill -0 $BACKEND_PID 2>/dev/null; then
            log_warning "launcher" "Backend didn't shut down gracefully, forcing..."
            kill -9 $BACKEND_PID
        fi
    fi

    # é€šçŸ¥å‰ç«¯ä¼˜é›…å…³é—­
    if [ -n "$FRONTEND_PID" ]; then
        log_info "launcher" "Shutting down frontend (PID: $FRONTEND_PID)"
        kill -TERM $FRONTEND_PID
        wait $FRONTEND_PID 2>/dev/null || true
    fi

    exit 0
}
```

### 3. å®¹å™¨å¯åŠ¨è„šæœ¬ï¼ˆentrypoint.shï¼‰

```bash
#!/bin/bash
set -e

# å¯¼å…¥å…±äº«åº“
source /app/scripts/lib/ui.sh
source /app/scripts/lib/utils.sh
source /app/scripts/lib/logging.sh
source /app/scripts/lib/signals.sh
source /app/scripts/lib/preflight.sh
source /app/scripts/lib/database.sh

# é…ç½®
APP_DIR="/app"
LOG_DIR="/var/log/app"
ENVIRONMENT="${ENVIRONMENT:-production}"

# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p "$LOG_DIR"

# è®¾ç½®æ—¥å¿—ï¼ˆå®¹å™¨å†…è¾“å‡ºåˆ° stdoutï¼‰
setup_container_logging

# è®¾ç½®ä¿¡å·å¤„ç†
setup_signal_handlers

# ç¯å¢ƒæ£€æµ‹å’ŒéªŒè¯
log_info "entrypoint" "Container starting..."
log_info "entrypoint" "Environment: $ENVIRONMENT"
log_info "entrypoint" "Python: $(python --version)"

# é¢„æ£€æŸ¥ï¼ˆç”Ÿäº§çº§åˆ«ï¼‰
log_info "entrypoint" "Running pre-flight checks..."
if ! run_all_checks; then
    log_error "entrypoint" "Pre-flight checks failed!"
    exit 1
fi

# æ•°æ®åº“è¿ç§»
log_info "entrypoint" "Running database migrations..."
if ! run_database_migration; then
    log_error "entrypoint" "Database migration failed!"
    exit 1
fi

# æ„å»ºå‰ç«¯ï¼ˆå¦‚æœéœ€è¦ï¼‰
log_info "entrypoint" "Building frontend..."
cd "$APP_DIR/frontend"
if [ -f "package.json" ]; then
    npm ci --production
    npm run build
fi

# å¯åŠ¨åç«¯
log_info "entrypoint" "Starting backend..."
cd "$APP_DIR"
WORKERS=$(get_optimal_workers)
python -m uvicorn src.main:app \
    --host 0.0.0.0 \
    --port 8000 \
    --workers "$WORKERS" \
    --access-log &
BACKEND_PID=$!

# ç­‰å¾…åç«¯å¯åŠ¨
sleep 2

# æ£€æŸ¥åç«¯å¥åº·çŠ¶æ€
log_info "entrypoint" "Checking backend health..."
if ! check_backend_health; then
    log_error "entrypoint" "Backend health check failed!"
    kill $BACKEND_PID 2>/dev/null || true
    exit 1
fi

log_info "entrypoint" "âœ… Container started successfully (Backend PID: $BACKEND_PID)"

# ç­‰å¾…ä¿¡å·ï¼ˆè¿™ä½¿å®¹å™¨ä¿æŒè¿è¡Œï¼‰
wait $BACKEND_PID
```

### 4. Docker å¤šé˜¶æ®µæ„å»º

```dockerfile
# Dockerfile

# é˜¶æ®µ 1: Python åç«¯æ„å»º
FROM python:3.12-slim as backend-builder

WORKDIR /app

# å®‰è£…ä¾èµ–
COPY backend/pyproject.toml backend/poetry.lock ./
RUN pip install poetry && poetry config virtualenvs.in-project true && poetry install --no-dev

# é˜¶æ®µ 2: Node å‰ç«¯æ„å»º
FROM node:20-slim as frontend-builder

WORKDIR /app/frontend

COPY frontend/package.json frontend/package-lock.json ./
RUN npm ci
COPY frontend ./
RUN npm run build

# é˜¶æ®µ 3: è¿è¡Œæ—¶
FROM python:3.12-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    curl \
    postgresql-client \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶åç«¯
COPY --from=backend-builder /app/.venv /app/.venv
COPY backend /app/backend

# å¤åˆ¶å‰ç«¯æ„å»ºäº§ç‰©
COPY --from=frontend-builder /app/frontend/dist /app/frontend/dist

# å¤åˆ¶å¯åŠ¨è„šæœ¬
COPY scripts /app/scripts

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV PATH="/app/.venv/bin:$PATH"
ENV PYTHONUNBUFFERED=1

# æš´éœ²ç«¯å£
EXPOSE 8000 3000

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
    CMD curl -f http://localhost:8000/health || exit 1

# å¯åŠ¨
ENTRYPOINT ["/app/scripts/container/entrypoint.sh"]
```

### 5. å¼€å‘å¯åŠ¨è„šæœ¬

```bash
#!/bin/bash
# scripts/dev/start.sh

set -e
source "$(dirname "$0")/../lib/ui.sh"
source "$(dirname "$0")/../lib/utils.sh"
source "$(dirname "$0")/../lib/logging.sh"
source "$(dirname "$0")/../lib/signals.sh"

# é…ç½®
ENVIRONMENT="development"
APP_DIR="$(cd "$(dirname "$0")/../.." && pwd)"
LOG_DIR="$APP_DIR/logs/dev"

# åˆ›å»ºæ—¥å¿—ç›®å½•
mkdir -p "$LOG_DIR"

# è®¾ç½®æ—¥å¿—ï¼ˆæœ¬åœ°è¾“å‡ºåˆ°æ–‡ä»¶å’Œç»ˆç«¯ï¼‰
setup_local_logging

# è®¾ç½®ä¿¡å·å¤„ç†
setup_signal_handlers

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   ğŸš€ å¼€å‘ç¯å¢ƒå¯åŠ¨                      â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# ç¯å¢ƒæ£€æµ‹
if [ -f ".dockerenv" ] || grep -q "docker" /proc/1/cgroup 2>/dev/null; then
    log_error "dev" "æ£€æµ‹åˆ°å®¹å™¨ç¯å¢ƒï¼å¼€å‘è„šæœ¬åº”åœ¨æœ¬åœ°è¿è¡Œ"
    exit 1
fi

# åŠ è½½å¼€å‘é…ç½®
source "$APP_DIR/scripts/config/dev.env"

# å¿«é€Ÿé¢„æ£€æŸ¥ï¼ˆä»…æ£€æŸ¥å¿…è¦é¡¹ï¼‰
log_info "dev" "Running quick pre-flight checks..."
check_command "python3" "Python 3"
check_command "poetry" "Poetry"
check_command "node" "Node.js"
check_command "npm" "npm/pnpm"

# åç«¯å¯åŠ¨
log_info "dev" "Starting backend with hot reload..."
cd "$APP_DIR/backend"
poetry run python -m uvicorn src.main:app \
    --host 127.0.0.1 \
    --port 8000 \
    --reload &
BACKEND_PID=$!
log_success "dev" "Backend started (PID: $BACKEND_PID)"

# å‰ç«¯å¯åŠ¨
log_info "dev" "Starting frontend with Vite..."
cd "$APP_DIR/frontend"
npm run dev &
FRONTEND_PID=$!
log_success "dev" "Frontend started (PID: $FRONTEND_PID)"

# æ˜¾ç¤ºä¿¡æ¯
echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘   âœ… æ‰€æœ‰æœåŠ¡å·²å¯åŠ¨                   â•‘"
echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
echo "â•‘   Backend:  http://localhost:8000     â•‘"
echo "â•‘   Frontend: http://localhost:5173     â•‘"
echo "â•‘   Logs:     $LOG_DIR                  â•‘"
echo "â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£"
echo "â•‘   æŒ‰ Ctrl+C åœæ­¢æ‰€æœ‰æœåŠ¡               â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# ç­‰å¾…ä¿¡å·
wait
```

---

## ç¬¬äº”éƒ¨åˆ†ï¼šCoolify é›†æˆæ–¹æ¡ˆ

### åœ¨ Coolify ä¸­çš„é…ç½®

#### 1. Dockerfile é…ç½®
```
åœ¨ Coolify ä¸­è®¾ç½®ï¼š
Source: GitHub repository
Dockerfile: ./Dockerfile
Build context: ./
```

#### 2. ç¯å¢ƒå˜é‡é…ç½®
```
åœ¨ Coolify UI ä¸­è®¾ç½®ï¼š

DATABASE_URL=postgresql+asyncpg://user:pass@host:5432/db
ENVIRONMENT=production
SECRET_KEY=xxxxx
CORS_ORIGINS=https://example.com
LOG_LEVEL=info
WORKERS=4
```

#### 3. å¥åº·æ£€æŸ¥é…ç½®
```
Path: /health
Method: GET
Timeout: 10s
Interval: 30s
Retries: 3
```

#### 4. æ—¥å¿—é…ç½®
```
å®¹å™¨å¯åŠ¨è„šæœ¬åªè¾“å‡ºåˆ° stdout/stderr
Coolify è‡ªåŠ¨æ”¶é›†å’Œå­˜å‚¨æ—¥å¿—
å¯åœ¨ Coolify UI ä¸­å®æ—¶æŸ¥çœ‹
```

### Coolify ä¸æˆ‘ä»¬è„šæœ¬çš„äº¤äº’

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Coolify Dashboard      â”‚
â”‚  (GitHub repo, env vars) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 1. Trigger deployment
             â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Docker Build           â”‚
â”‚   (Build Dockerfile)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 2. Create image
             â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Docker Run             â”‚
â”‚   (Start container)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 3. ENTRYPOINT
             â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  /app/scripts/container  â”‚
â”‚  /entrypoint.sh          â”‚
â”‚  (Our startup script)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 4. Initialize app
             â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   App Running            â”‚
â”‚   (uvicorn + frontend)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â”‚ 5. Healthcheck
             â¬‡
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Coolify Monitoring     â”‚
â”‚   (Logs, metrics)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¬¬å…­éƒ¨åˆ†ï¼šæœ€ç»ˆæ–¹æ¡ˆæ€»ç»“

### ğŸ“Š æ–¹æ¡ˆå¯¹æ¯”

| ç‰¹æ€§ | å¼€å‘ç¯å¢ƒ | å®¹å™¨ç”Ÿäº§ |
|------|---------|---------|
| **å¯åŠ¨æ–¹å¼** | `./scripts/dev/start.sh` | Dockerfile ENTRYPOINT |
| **è¿›ç¨‹ç®¡ç†** | æœ¬åœ°åå°è¿›ç¨‹ | Docker å®¹å™¨ç®¡ç† |
| **æ—¥å¿—è¾“å‡º** | æ–‡ä»¶ + ç»ˆç«¯ | stdout/stderr |
| **ä¼˜é›…å…³é—­** | SIGINT/SIGTERM | Docker SIGTERM |
| **çƒ­é‡è½½** | âœ… Uvicorn reload + Vite HMR | âœ— ä¸æ”¯æŒ |
| **æ•°æ®åº“è¿ç§»** | æ‰‹åŠ¨è¿è¡Œ | è‡ªåŠ¨è¿è¡Œ |
| **å¥åº·æ£€æŸ¥** | æ‰‹åŠ¨æ£€æŸ¥ | Coolify è‡ªåŠ¨ |
| **æ‰©å®¹** | N/A | åˆ›å»ºæ–°å®¹å™¨ |

### ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

1. **å¼€å‘é«˜æ•ˆ**
   - çƒ­é‡è½½è‡ªåŠ¨æ›´æ–°
   - å¿«é€Ÿå¯åœ
   - ä¾¿æ·è°ƒè¯•

2. **ç”Ÿäº§å¯é **
   - å®Œæ•´çš„é¢„æ£€æŸ¥
   - è‡ªåŠ¨æ•°æ®åº“è¿ç§»
   - ä¼˜é›…å…³é—­æœºåˆ¶
   - Coolify è‡ªåŠ¨é‡å¯

3. **è¿ç»´å‹å¥½**
   - ç»Ÿä¸€çš„å¯åŠ¨æµç¨‹
   - æ¸…æ™°çš„æ—¥å¿—
   - ç®€åŒ–çš„éƒ¨ç½²

4. **æˆæœ¬æ§åˆ¶**
   - æ— éœ€é¢å¤–å·¥å…·
   - çº¯ Bash å®ç°
   - å®¹å™¨ä½“ç§¯å°

---

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šå®æ–½è·¯çº¿å›¾

### Phase 1ï¼ˆDay 1-2ï¼‰ï¼šåŸºç¡€æ¡†æ¶
- [ ] åˆ›å»ºç›®å½•ç»“æ„
- [ ] å®ç°å…±äº«åº“ï¼ˆlib/ï¼‰
- [ ] ç¯å¢ƒæ£€æµ‹æœºåˆ¶
- [ ] é…ç½®æ–‡ä»¶æ¨¡æ¿

### Phase 2ï¼ˆDay 3ï¼‰ï¼šå¼€å‘å¯åŠ¨è„šæœ¬
- [ ] å¼€å‘ç¯å¢ƒå¯åŠ¨è„šæœ¬ï¼ˆscripts/dev/start.shï¼‰
- [ ] æœ¬åœ°è¿è¡Œæµ‹è¯•
- [ ] Makefile ä¾¿æ·å‘½ä»¤

### Phase 3ï¼ˆDay 4ï¼‰ï¼šå®¹å™¨å¯åŠ¨è„šæœ¬
- [ ] å®¹å™¨å¯åŠ¨è„šæœ¬ï¼ˆscripts/container/entrypoint.shï¼‰
- [ ] Dockerfile å¤šé˜¶æ®µæ„å»º
- [ ] æœ¬åœ°å®¹å™¨æµ‹è¯•

### Phase 4ï¼ˆDay 5ï¼‰ï¼šå¢å¼ºåŠŸèƒ½
- [ ] æ—¥å¿—ç®¡ç†å®Œå–„
- [ ] å¥åº·æ£€æŸ¥é›†æˆ
- [ ] ä¿¡å·å¤„ç†å®Œå–„

### Phase 5ï¼ˆDay 6ï¼‰ï¼šæ–‡æ¡£å’Œéƒ¨ç½²
- [ ] å®Œæ•´æ–‡æ¡£
- [ ] Coolify é…ç½®æŒ‡å—
- [ ] æ•…éšœæ’é™¤æŒ‡å—

---

## æ€»ä½“ç»“è®º

### âœ… æ¨èçš„æœ€ç»ˆæ–¹æ¡ˆï¼š

**"åŒç¯å¢ƒæ··åˆå¯åŠ¨ç³»ç»Ÿ"**

**æ ¸å¿ƒè®¾è®¡ï¼š**
1. å…±äº«çš„åŠŸèƒ½åº“ï¼ˆlib/ï¼‰- ä¸¤ä¸ªç¯å¢ƒéƒ½ä½¿ç”¨
2. åˆ†ç¦»çš„å¯åŠ¨è„šæœ¬ - dev ä¼˜åŒ– + å®¹å™¨ä¼˜åŒ–
3. ç¯å¢ƒæ£€æµ‹æœºåˆ¶ - è‡ªåŠ¨é€‰æ‹©æ­£ç¡®çš„æ‰§è¡Œè·¯å¾„
4. ä¿¡å·å¤„ç† - ä¼˜é›…å…³é—­
5. Docker åŸç”Ÿå¯åŠ¨ - é€šè¿‡ ENTRYPOINT

**å…³é”®æ–‡ä»¶ï¼š**
```
scripts/
â”œâ”€â”€ lib/              # å…±äº«åº“
â”œâ”€â”€ dev/start.sh      # å¼€å‘å¯åŠ¨
â”œâ”€â”€ container/entrypoint.sh  # å®¹å™¨å¯åŠ¨
â””â”€â”€ config/           # ç¯å¢ƒé…ç½®
```

**ä¼˜åŠ¿ï¼š**
- âœ… å¼€å‘ç¯å¢ƒæœ€ä¼˜åŒ–ï¼ˆçƒ­é‡è½½ã€å¿«é€Ÿè¿­ä»£ï¼‰
- âœ… å®¹å™¨ç”Ÿäº§æœ€ä¼˜åŒ–ï¼ˆæœ€å°åŒ–ã€å¯é æ€§ï¼‰
- âœ… ä»£ç é«˜åº¦å¤ç”¨ï¼ˆå…±äº«åº“ï¼‰
- âœ… Coolify æ— ç¼é›†æˆ
- âœ… é›¶é¢å¤–ä¾èµ–

**ä¸‹ä¸€æ­¥ï¼š** ç«‹å³å¼€å§‹ Phase 1 çš„å®ç°

---

**æ–‡æ¡£ç”Ÿæˆæ—¥æœŸ**: 2025-11-12
**åˆ†æå®Œæ•´æ€§**: âœ… 100%
**æ¨èå¯è¡Œæ€§**: âœ… é«˜åº¦å¯è¡Œ
